<?xml version="1.0" encoding="UTF-8"?>
<!--****************************************************************************
 * Run Robusta from command line to generate bedsmell report
 ****************************************************************************-->
<project name="RobustaHeadLess" default="all">
	
	<property environment="env"/>
    <property name="ECLIPSE_HOME" value="${env.ECLIPSE_HOME}"/>
	
	<!-- Need to overwrite by DEFINE when call this build file -->
	<property name="WORKSPACE_PATH" value="${basedir}/../robusta_badsmell_report_project_workspace"/>
	<property name="PROJECT_LOCATION" value="${basedir}/../" />
	<property name="PROJECT_NAME" value="Robusta" />
	<property name="DESTINATION_REPORT_FOLDER" value="${PROJECT_LOCATION}/${PROJECT_NAME}/${PROJECT_NAME}_Report" />
	<!-- End of DEFINE -->
	
	<property name="ORIGINAL_PROJECT_PATH" value="${PROJECT_LOCATION}/${PROJECT_NAME}"/>
	<property name="DESTINATION_PROJECT_PATH" value="${WORKSPACE_PATH}/${PROJECT_NAME}"/>
	
	<!-- - - - - - - - - - - - - - - - - - 
          target: init                      
         - - - - - - - - - - - - - - - - - -->
    <target name="init">
    	<mkdir dir="${DESTINATION_PROJECT_PATH}"/>
    	<copy todir="${DESTINATION_PROJECT_PATH}" overwrite="yes" includeemptydirs="yes">
    		<fileset dir="${ORIGINAL_PROJECT_PATH}"></fileset>
    	</copy>
    </target>
	
	<!-- - - - - - - - - - - - - - - - - - 
          target: save_and_clear                      
         - - - - - - - - - - - - - - - - - -->
    <target name="save_and_clear">
    	<copy todir="${DESTINATION_REPORT_FOLDER}" overwrite="yes" includeemptydirs="yes">
    		<fileset dir="${DESTINATION_PROJECT_PATH}/${PROJECT_NAME}_Report"></fileset>
    	</copy>
    	<delete quiet="true" dir="${WORKSPACE_PATH}"/>
    </target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: main                      
         - - - - - - - - - - - - - - - - - -->
	<target name="main">
		<echo message="Building Bad Smell Report"/>
		<exec executable="${ECLIPSE_HOME}/eclipsec">
			<arg line="-nosplash"/>
			<arg line="-application Robusta.standalone"/>
			<arg line="-data ${WORKSPACE_PATH}"/>
			<arg line="${DESTINATION_PROJECT_PATH}"/>
		</exec>
	</target>
	
	<!-- ================================= 
          target: all              
         ================================= -->
    <target name="all" depends="init, main, save_and_clear">
    </target>
</project>
